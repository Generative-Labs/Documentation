"use strict";(self.webpackChunkchat_service_api_doc=self.webpackChunkchat_service_api_doc||[]).push([[5479],{3905:function(t,e,n){n.d(e,{Zo:function(){return u},kt:function(){return c}});var a=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var i=a.createContext({}),p=function(t){var e=a.useContext(i),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},u=function(t){var e=p(t.components);return a.createElement(i.Provider,{value:e},t.children)},m={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},d=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,l=t.originalType,i=t.parentName,u=s(t,["components","mdxType","originalType","parentName"]),d=p(n),c=r,g=d["".concat(i,".").concat(c)]||d[c]||m[c]||l;return n?a.createElement(g,o(o({ref:e},u),{},{components:n})):a.createElement(g,o({ref:e},u))}));function c(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=n.length,o=new Array(l);o[0]=d;var s={};for(var i in e)hasOwnProperty.call(e,i)&&(s[i]=e[i]);s.originalType=t,s.mdxType="string"==typeof t?t:r,o[1]=s;for(var p=2;p<l;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},388:function(t,e,n){n.r(e),n.d(e,{assets:function(){return u},contentTitle:function(){return i},default:function(){return c},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return m}});var a=n(7462),r=n(3366),l=(n(7294),n(3905)),o=["components"],s={sidebar_position:2},i="Connect Chat Channel",p={unversionedId:"Web3MQ-RESTFul-API/Room/connect-channel",id:"Web3MQ-RESTFul-API/Room/connect-channel",title:"Connect Chat Channel",description:"_",source:"@site/docs/Web3MQ-RESTFul-API/Room/connect-channel.md",sourceDirName:"Web3MQ-RESTFul-API/Room",slug:"/Web3MQ-RESTFul-API/Room/connect-channel",permalink:"/docs/Web3MQ-RESTFul-API/Room/connect-channel",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Create Chat Room",permalink:"/docs/Web3MQ-RESTFul-API/Room/create-room"},next:{title:"Get Room Info",permalink:"/docs/Web3MQ-RESTFul-API/Room/get-room-info"}},u={},m=[{value:"Connect to a Room&#39;s channel by MQTT protocol over Websocket",id:"connect-to-a-rooms-channel-by-mqtt-protocol-over-websocket",level:2},{value:"MQTT connection parameters",id:"mqtt-connection-parameters",level:2},{value:"Send Message",id:"send-message",level:2},{value:"Message&#39;s structure",id:"messages-structure",level:3},{value:"Subsribe your rooms",id:"subsribe-your-rooms",level:2},{value:"publish messages to your room",id:"publish-messages-to-your-room",level:2}],d={toc:m};function c(t){var e=t.components,n=(0,r.Z)(t,o);return(0,l.kt)("wrapper",(0,a.Z)({},d,n,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"connect-chat-channel"},"Connect Chat Channel"),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"connect-to-a-rooms-channel-by-mqtt-protocol-over-websocket"},"Connect to a Room's channel by MQTT protocol over Websocket"),(0,l.kt)("p",null,"We recommend that you use Eclipse Paho MQTT client to connect. And you can download the Client SDK for the programming language which you are using from the following link."),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=downloads.php"},"Eclipse Paho MQTT Client")),(0,l.kt)("p",null,"If you have already installed one of the Client SDKs, then you can view the documentation for each SDK from the following links."),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/python/docs/index.php"},"Python MQTT Client")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/java/index.php"},"Java MQTT Client")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/js/index.php"},"JavaScript MQTT Client")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/golang/index.php"},"Go MQTT Client")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/c/index.php"},"C MQTT Client")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/cpp/index.php"},"C++ MQTT Client")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/rust/index.php"},"Rust MQTT Client")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.eclipse.org/paho/index.php?page=clients/dotnet/index.php"},".Net/C# MQTT Client")),(0,l.kt)("h2",{id:"mqtt-connection-parameters"},"MQTT connection parameters"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"MQTT endpoint:")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Production env:     ",(0,l.kt)("strong",{parentName:"li"},"wss://msg.web3messaging.online/mqtt")),(0,l.kt)("li",{parentName:"ul"},"Development env:    ",(0,l.kt)("strong",{parentName:"li"},"wss://test-msg.web3messaging.online/mqtt"))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"JWT: No")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Call Method: WebSocket")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Parameters"),(0,l.kt)("th",{parentName:"tr",align:null},"Required"),(0,l.kt)("th",{parentName:"tr",align:null},"Parameters Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"username"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"the username of mqtt client,must be user's OID")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"password"),(0,l.kt)("td",{parentName:"tr",align:null},"Yes"),(0,l.kt)("td",{parentName:"tr",align:null},"the password of mqtt client,must be user's jwt")))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Return:")),(0,l.kt)("p",null,"None thing"),(0,l.kt)("h2",{id:"send-message"},"Send Message"),(0,l.kt)("p",null,"just call MQTT's publish function."),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},'the topic where message send to is "',(0,l.kt)("strong",{parentName:"p"},"msg/+user's OID"),'"')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'msg = Message(...)\nclient.pub("msg/e324r234r2342",msg)\n')),(0,l.kt)("h3",{id:"messages-structure"},"Message's structure"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Parameters"),(0,l.kt)("th",{parentName:"tr",align:null},"Type"),(0,l.kt)("th",{parentName:"tr",align:null},"Required"),(0,l.kt)("th",{parentName:"tr",align:null},"Parameters Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"from_uid"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"user' OID who sent the message")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"to_room_id"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"room's OID which should receivced the message")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"msg_type"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"one of 'text' and 'sudo_swap_card'")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"msg_contents"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if msg_type is 'text',it is pure text,if msg_type is 'sudo_swap_card',see ",(0,l.kt)("strong",{parentName:"td"},"sudo_swap_card's structure")," Please see the notes below this form")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"is_thread"),(0,l.kt)("td",{parentName:"tr",align:null},"bool"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"was it a thread,default is no")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"is_opensea_item_thread"),(0,l.kt)("td",{parentName:"tr",align:null},"bool"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"was it a OpenSea item,default is no")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"opensea_item_contract_address"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if is_opensea_item_thread is true, it should be NFT's contract address")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"opensea_item_token_id"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if is_opensea_item_thread is true, it should be NFT's token id")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"opensea_item_name"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if is_opensea_item_thread is true, it should be NFT's name")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"opensea_item_description"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if is_opensea_item_thread is true, it should be NFT's description")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"opensea_item_image_url"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if is_opensea_item_thread is true, it should be NFT's image path")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"belong_to_thread_id"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if message was belong to any thread,it should be the thread's OID")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"reply_to_msg_id"),(0,l.kt)("td",{parentName:"tr",align:null},"string"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"if message was reply to any msg,it should be the thread's OID")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"created_at"),(0,l.kt)("td",{parentName:"tr",align:null},"int"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"the unix time stamp when the message sent")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"at_user_ids"),(0,l.kt)("td",{parentName:"tr",align:null},"list"),(0,l.kt)("td",{parentName:"tr",align:null},"yes"),(0,l.kt)("td",{parentName:"tr",align:null},"default value is empty list []")))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},'message ACK: if message was sent, the sender will received the message that includes a new parameter "id"')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"sudo_swap_card's structure")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n        "orderStatus" : "OPEN",\n        "expiryDate" : "2022-05-14, 12:00 AM",\n        "creatorAddress" : "0x0f4dc815bccd5da44e6ba06140c710813078510d",\n        "recipientAddress" : "",\n        "jumpUrl" : "https://sudoswap.xyz/#/swap/0x0f4dc815bccd5da44e6ba06140c710813078510d/1",\n        "asset1Data" : [\n            {\n                "address" : "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",\n                "type" : "1",\n                "amount" : "3.5",\n                "imgURL" : "https://zapper.fi/images/WETH-icon.png",\n                "name" : "Wrapped Ether",\n                "symbol" : "WETH"\n            }\n        ],\n        "asset2Data" : [\n            {\n                "address" : "0x9df8aa7c681f33e442a0d57b838555da863504f3",\n                "type" : "2",\n                "id" : "1086",\n                "amount" : "1",\n                "imgURL" : "https://lh3.googleusercontent.com/3cYi9Y9p_ZEPKsIGcMuCnfZTKP3Q6hPDUfkaVMAZbVKRs88NpdOPCepQFMnKIT22Rh2E2Z8IcAYul4JiPhm12nfv0A0zKCUOz9AB=s250",\n                "name" : "Pixelated Llama",\n                "symbol" : "PXLLMA"\n            }\n        ]\n    }\n')),(0,l.kt)("h2",{id:"subsribe-your-rooms"},"Subsribe your rooms"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"first call ",(0,l.kt)("a",{parentName:"p",href:"/docs/Web3MQ-RESTFul-API/Room/get-chat-rooms"},"my_rooms")," to get all rooms' id that you are participating in.")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'msg = Message(...)\nclient.subscribe("chat/room_id",msg)\n')),(0,l.kt)("h2",{id:"publish-messages-to-your-room"},"publish messages to your room"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'msg = Message(...)\nclient.pub("msg/your_user_id",msg)\n')))}c.isMDXComponent=!0}}]);