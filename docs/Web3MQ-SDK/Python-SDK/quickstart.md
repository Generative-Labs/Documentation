---
sidebar_position: 1
---

# Quickstart
___

## Usage

1. Install web3mq sdk
2. Init web3mq client
3. Call Register function
4. Get login random secret
5. Sign login_random_secret in MetaMask
6. Call User Login function
7. Connect to chat server
8. Send message

### Install

```bash
pip intall web3mq
```

### Init web3mq client

```python
from web3mq.client import Web3mqClient

# default env is prod
prod_client = Web3mqClient()

# Specify test environment
test_client = Web3mqClient(env='test')
```

### Register

```python
from web3mq.client import Web3mqClient

client = Web3mqClient()

result = client.do_register(
    "your wallet address", # User's ETH wallet address, get it by MetaMask's API
    'twitter', # platform options twitter/instagram/facebook/discord
    'your username in twitter'
)
```

### Get login random secret

```python
from web3mq.client import Web3mqClient

client = Web3mqClient()

wallet_address = "your wallet address"

login_random_secret = client.login_random_secret(wallet_address)
```

### Sign login_random_secret in MetaMask

> sign in metamask in browser use javascript

```js
let signContent = `Web3MQ wants you to sign in with your Ethereum account:
${your_wallet_address}
Sign-In With Ethereum Example Statement
URI: https://chat.web3messaging.online
Version: 1
Chain ID: 1
Nonce: ${your login random secret}
Issued At: 2022-05-23T12:52:57.500Z
Expiration Time: 2022-05-25T12:52:57.489Z`;

const signature = await ethereum.request({
  method: "personal_sign",
  params: [signContent, your_wallet_address, "swapchat"],
});

alert("Your MetaMask's signature is: " + signature)
```

### Login

```python
from web3mq.client import Web3mqClient

client = Web3mqClient()

# Generated by MetaMask-Sign with user's random login secret
signature = "signature"

result = client.do_login("login random secret", signature, "your wallet address")

jwt_data = result['access_token']
```

### Connect to server

```python
import paho.mqtt.client as mqtt

CHAT_SERVER_DOMAIN = "msg.web3messaging.online"
# test env test-msg.web3messaging.online

def get_chat_client(client_id):
    mqttc = mqtt.Client(client_id, transport="websockets")
    return mqttc

# Get access_token from previou login function
jwt_data = "access token"

# extract user_id from jwt_data
user_id = "your user_id"

chatclient = get_chat_client(user_id)
chatclient.tls_set()
chatclient.username_pw_set(username=user_id, password=jwt_data)

chatclient.connect(CHAT_SERVER_DOMAIN, 443)
```

### Send message

```python
import json

# extract user_id from "access_token" from login api response
user_id = "your user_id"

topic = "msg/" + user_id

payload = {
    "from_uid" : user_id,
    "to_room_id" : room_id,
    "msg_contents" : "Hello",
    "msg_type" : "text"
}

chatclient.publish(topic, json.dumps(payload))
```
